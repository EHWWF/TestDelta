<?xml version = '1.0' encoding = 'UTF-8'?>
<!--Generated by Oracle SOA Modeler version 11.1.1.7.0 at [9/17/14 5:29 PM].-->
<Mediator name="QPlanMediator" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://xmlns.oracle.com/sca/1.0/mediator"
          wsdlTargetNamespace="http://xmlns.bayer.com/ipms/qplan"
          xmlns:tns="http://xmlns.bayer.com/ipms/qplan">
  <operation name="execute" deliveryPolicy="AllOrNothing" priority="4"
             validateSchema="true">
    <switch>
      <case executionType="direct" name="CreateProject.CreateProject.process">
        <condition language="xpath">
          <expression>$in.request/tns:callQPlan/tns:createProject</expression>
        </condition>
        <action>
          <assign>
            <copy target="$out.payload" expression="$in.request"/>
            <copy target="$out.property.tracking.compositeInstanceTitle"
                  expression="med:setCompositeInstanceTitle(concat('CreateProject:', $in.request/ipms-qplan:callQPlan/@id))"
                  xmlns:ipms-qplan="http://xmlns.bayer.com/ipms/qplan"
                  xmlns:med="http://schemas.oracle.com/mediator/xpath"/>
          </assign>
          <invoke reference="CreateProject.CreateProject" operation="process">
            <onCallback operation="processResponse">
              <assign>
                <copy target="$out.callback" expression="$in.payload"/>
              </assign>
              <callback operation="callback"/>
            </onCallback>
          </invoke>
        </action>
      </case>
      <case executionType="direct" name="UpdateProject.UpdateProject.process_2">
        <condition language="xpath">
          <expression>$in.request/tns:callQPlan/tns:updateProject</expression>
        </condition>
        <action>
          <assign>
            <copy target="$out.payload" expression="$in.request"
                  xmlns:ipms-qplan="http://xmlns.bayer.com/ipms/qplan"/>
            <copy target="$out.property.tracking.compositeInstanceTitle"
                  expression="med:setCompositeInstanceTitle(concat('UpdateProject:', $in.request/ipms-qplan:callQPlan/@id))"
                  xmlns:ipms-qplan="http://xmlns.bayer.com/ipms/qplan"
                  xmlns:med="http://schemas.oracle.com/mediator/xpath"/>
          </assign>
          <invoke reference="UpdateProject.UpdateProject" operation="process">
            <onCallback operation="processResponse">
              <assign>
                <copy target="$out.callback" expression="$in.payload"/>
              </assign>
              <callback operation="callback"/>
            </onCallback>
          </invoke>
        </action>
      </case>
      <case executionType="direct" name="ReadTimeline.ReadTimeline.process">
        <condition language="xpath">
          <expression>$in.request/tns:callQPlan/tns:readTimeline</expression>
        </condition>
        <action>
          <assign>
            <copy target="$out.payload" expression="$in.request"/>
            <copy target="$out.property.tracking.compositeInstanceTitle"
                  expression="med:setCompositeInstanceTitle(concat('ReadTimeline:', $in.request/ipms-qplan:callQPlan/@id))"
                  xmlns:ipms-qplan="http://xmlns.bayer.com/ipms/qplan"
                  xmlns:med="http://schemas.oracle.com/mediator/xpath"/>
          </assign>
          <invoke reference="ReadTimeline.ReadTimeline" operation="process">
            <onCallback operation="processResponse">
              <assign>
                <copy target="$out.callback" expression="$in.payload"/>
              </assign>
              <callback operation="callback"/>
            </onCallback>
          </invoke>
        </action>
      </case>
      <case executionType="direct"
            name="ReadPlaceholderStudies.ReadPlaceholderStudies.process">
        <condition language="xpath">
          <expression>$in.request/tns:callQPlan/tns:readPlaceholderStudies</expression>
        </condition>
        <action>
          <assign>
            <copy target="$out.payload" expression="$in.request"/>
            <copy target="$out.property.tracking.compositeInstanceTitle"
                  expression="med:setCompositeInstanceTitle(concat('ReadPlaceholderStudies:', $in.request/ipms-qplan:callQPlan/@id))"
                  xmlns:ipms-qplan="http://xmlns.bayer.com/ipms/qplan"
                  xmlns:med="http://schemas.oracle.com/mediator/xpath"/>
          </assign>
          <invoke reference="ReadPlaceholderStudies.ReadPlaceholderStudies"
                  operation="process">
            <onCallback operation="processResponse">
              <assign>
                <copy target="$out.callback" expression="$in.payload"/>
              </assign>
              <callback operation="callback"/>
            </onCallback>
          </invoke>
        </action>
      </case>
      <case executionType="direct" name="echo.execute" defaultRule="true">
        <action>
          <assign>
            <copy target="$out.callback/ipms-soa:response/ns0:error/ns0:description"
                  value='"Operation not implemented"'
                  xmlns:tns="http://xmlns.bayer.com/ipms/qplan"
                  xmlns:ns0="http://xmlns.bayer.com/ipms"
                  xmlns:ipms-soa="http://xmlns.bayer.com/ipms/soa"/>
            <copy target="$out.callback/ipms-soa:response/@id"
                  expression="$in.request/ipms-qplan:callQPlan/@id"
                  xmlns:ipms-qplan="http://xmlns.bayer.com/ipms/qplan"
                  xmlns:ipms-soa="http://xmlns.bayer.com/ipms/soa"/>
          </assign>
          <echo operation="callback"/>
        </action>
      </case>
    </switch>
  </operation>
</Mediator>
